<header class="trace_info clearfix">
    <h2 class="title">
        <div class="name">#<%= @frame.name %></div>
        <div class="location"><span class="filename"><a href="<%= editor_url(@frame) %>"><%= @frame.pretty_path %></a></span></div>
    </h2>
    <div class="code_block clearfix">
        <%== html_formatted_code_block @frame %>
    </div>

    <% if BetterErrors.binding_of_caller_available? && @frame.frame_binding %>
        <div class="be-repl">
            <div class="be-console">
                <pre></pre>
                <div class="command-line"><span class='prompt'>&gt;&gt;</span> <input tabindex="1"/></div>
            </div>
        </div>
    <% end %>
</header>

<% if BetterErrors.binding_of_caller_available? && @frame.frame_binding %>
    <div class="hint">
        This is a live shell. Type in here.
    </div>

    <div class="variable_info"></div>
<% end %>

<% unless BetterErrors.binding_of_caller_available? %>
    <div class="hint">
        <strong>Tip:</strong> add <code>gem "binding_of_caller"</code> to your Gemfile to enable the REPL and local/instance variable inspection.
    </div>
<% end %>

<div class="variables">
    <h3>Request Info</h3>
    <% if rails_params %>
        <h4 class="name">Request Parameters</h4>
        <pre><%== inspect_value rails_params %></pre>
    <% end %>
    <% if rack_session %>
        <h4 class="name">Rack Session</h4>
        <pre><%== inspect_value rack_session %></pre>
    <% end %>

<% if BetterErrors.binding_of_caller_available? && @frame.frame_binding %>
    <h3>Local Variables</h3>
    <% @frame.local_variables.each do |name, value| %>
        <h4 class="name"><%= name %></h4>
        <pre><%== inspect_value value %></pre>
    <% end %>

    <h3>Instance Variables (<%= @frame.class_name %>)</h3>
    <% @frame.instance_variables.each do |name, value| %>
        <h4 class="name"><%= name %></h4>
        <pre><%== inspect_value value %></pre>
    <% end %>

    <!-- <%= Time.now.to_f - @var_start_time %> seconds -->
<% end %>
